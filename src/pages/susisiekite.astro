---
import LayoutLt from "../layouts/Layout_Lt.astro";
import "../styles/style.css";
import "../styles/contact-us.css";
import instagram from "../assets/social_icons/instagram.png";
import linkedin from "../assets/social_icons/linkedin.png";
import tiktok from "../assets/social_icons/tiktok.png";
import facebook from "../assets/social_icons/facebook.png";
import favicon from "../assets/favicon.png"
---

<html lang="lt">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="format-detection" content="email=no">
    <link rel="icon" type="image/png" href={favicon.src}> 
    <title>Perkūnas RT | Susisiekite</title>
  </head>
  <body>
    <LayoutLt>
      <div class="w-block first">
        <div class="container card">
          <div class="contact">
            <h1>Susisiekite!</h1>
            <div class="b-block form-container">
              <form
                class="form"
                method="post"
                data-netlify="true"
                id="contact-form"
              >
                <label for="name">Vardas</label>
                <input type="text" name="name" placeholder="Vardas" required />
                <label for="email">El. Paštas</label>
                <input
                  type="email"
                  name="email"
                  placeholder="El. Paštas"
                  required
                />
                <label for="message">Žinutė</label>
                <textarea
                  name="message"
                  rows="4"
                  placeholder="Jūsų žinutė"
                  required></textarea>
                <label for="reason">Tema</label>
                <select name="reason" required>
                  <option value="">Pasirinkite...</option>
                  <option value="Sponsorship">Partnerystė</option>
                  <option value="Recruitment">Narystė</option>
                  <option value="Other">Kita</option>
                </select>

                <button type="submit" class="w-block">Siųsti</button>
              </form>
              <div id="success-alert" class="success-alert" style="display: none;">
                Ačiū! Jūsų žinutė buvo nusiųsta sėkmingai.
              </div>   
            </div>
          </div>
          <div class="info">
            <p>
              Dėl partnerystės, narystės
              organizacijoje ar kitų klausimų, naudokite šią formą arba siųskite el. laišką vienu
              iš šių adresų:
            </p>
            <p>
              <span class="support-email"
                >perkunasrt@gmail.com</span
              >
            </p>
            <p>
              <span class="support-email"
                >benluk2@ktu.lt</span
              >
            </p>
            <p>
              <span class="support-email"
                >deimic@ktu.lt</span
              >
            <p class="last"></p>
            <p style="text-align: center;">Taip pat galite susiekti su mumis per socialinius tinklus!</p>
            <div class="contact-socials">
              <a
                href="https://www.instagram.com/perkunasrt_ktu/"
                target="_blank"
                ><img src={instagram.src} alt="instagram" width="70px" /></a
              >
              <a
                href="https://www.linkedin.com/company/perkunasrt/"
                target="_blank"
                ><img src={linkedin.src} alt="Linkedin" width="70px" /></a
              >
              <a
                href="https://www.tiktok.com/@perknasrt_ktu?is_from_webapp=1&sender_device=pc"
                target="_blank"
                ><img src={tiktok.src} alt="tiktok" width="70px" /></a
              >
              <a
                href="https://www.facebook.com/profile.php?id=61575797945434&mibextid=wwXIfr&rdid=w6NzlkfwTN15CfNp&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1AUCo2Zyu8%2F%3Fmibextid%3DwwXIfr"
                target="_blank"
                ><img src={facebook.src} alt="facebook" width="70px" /></a
              >
            </div>
          </div>
        </div>
      </div>
    </LayoutLt>
  </body>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("contact-form") as HTMLFormElement | null;
  const alertBox = document.getElementById("success-alert") as HTMLElement | null;

  if (form && alertBox) {
    form.addEventListener("submit", (e: Event) => {
      e.preventDefault();

      const formData = new FormData(form);
      const formEntries = Array.from(formData.entries()).map(([key, value]) => [
        key,
        typeof value === "string" ? value : value.name,
      ]);

      const encoded = new URLSearchParams(formEntries as [string, string][]).toString();

      fetch("/", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: encoded,
      })
        .then(() => {
          alertBox.style.display = "block";
          alertBox.style.opacity = "1";
          form.reset();

          setTimeout(() => {
            alertBox.style.opacity = "0";
            setTimeout(() => {
              alertBox.style.display = "none";
            }, 300); // extra delay to allow fade out
          }, 800); // 0.5 second display
        })
        .catch(() => alert("Oops! Something went wrong."));
    });
  }
});

  </script>
</html>
